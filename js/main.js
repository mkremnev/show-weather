(()=>{"use strict";(()=>{function e(e,t){e.innerHTML="";const{name:n,current:a,daily:i,history:o}=t;!function(e,t,n){e.insertAdjacentHTML("afterbegin",`\n          <header\n          class="\n            city-navigation\n            d-flex\n            flex-wrap\n            justify-content-between\n            align-items-center\n          "\n        >\n          <div class="icon-city">\n            <svg\n              width="69"\n              height="69"\n              viewBox="0 0 69 69"\n              fill="none"\n              xmlns="http://www.w3.org/2000/svg"\n            >\n              <g opacity="0.7">\n                <path\n                  d="M8.625 54.625V16.3875C8.62482 15.7973 8.80627 15.2214 9.14471 14.7379C9.48314 14.2544 9.96217 13.8868 10.5167 13.685L38.3209 3.57649C38.5381 3.49744 38.7711 3.47193 39.0003 3.50212C39.2294 3.53231 39.4479 3.61731 39.6372 3.74991C39.8265 3.88251 39.981 4.0588 40.0877 4.26384C40.1944 4.46887 40.2501 4.69661 40.25 4.92774V19.1676L58.4085 25.2195C58.9812 25.4102 59.4794 25.7764 59.8323 26.2661C60.1853 26.7558 60.3751 27.3442 60.375 27.9479V54.625H66.125V60.375H2.875V54.625H8.625ZM14.375 54.625H34.5V11.0831L14.375 18.4029V54.625ZM54.625 54.625V30.0207L40.25 25.2281V54.625H54.625Z"\n                  fill="white"\n                  fill-opacity="0.8"\n                />\n              </g>\n            </svg>\n          </div>\n          <div class="title-wrapper">\n            <h1 class="city-title text-center">${t}</h1>\n            <div class="cities-submenu"></div>\n          </div>\n          <button type="button" class="btn-city">\n            <svg\n              width="70"\n              height="70"\n              viewBox="0 0 70 70"\n              fill="none"\n              xmlns="http://www.w3.org/2000/svg"\n            >\n              <g opacity="0.7">\n                <path\n                  d="M35 8.75C31.7916 8.75 29.1666 11.375 29.1666 14.5833C29.1666 17.7917 31.7916 20.4167 35 20.4167C38.2083 20.4167 40.8333 17.7917 40.8333 14.5833C40.8333 11.375 38.2083 8.75 35 8.75ZM35 49.5833C31.7916 49.5833 29.1666 52.2083 29.1666 55.4167C29.1666 58.625 31.7916 61.25 35 61.25C38.2083 61.25 40.8333 58.625 40.8333 55.4167C40.8333 52.2083 38.2083 49.5833 35 49.5833ZM35 29.1667C31.7916 29.1667 29.1666 31.7917 29.1666 35C29.1666 38.2083 31.7916 40.8333 35 40.8333C38.2083 40.8333 40.8333 38.2083 40.8333 35C40.8333 31.7917 38.2083 29.1667 35 29.1667Z"\n                  fill="white"\n                />\n              </g>\n            </svg>\n          </button>\n        </header>\n`),e.insertAdjacentHTML("beforeend",'\n  <div class="modal-city-container">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n          <h5 class="modal-title">Show Weather</h5>\n          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n      </div>\n      <div class="modal-body">\n        <form class="d-flex flex-column justify-content-center p-4 ">\n          <div class="mb-3">    \n            <label for="city" class="form-label">Введите название города</label>\n            <input class="city-input form-control" name="city" type="text" />\n          </div>\n          <button type="submit" class="btn btn-primary">Найти</button>\n        </form>\n      </div>\n    </div>\n  </div>\n  </div>\n  ');const a=e.querySelector(".cities-submenu"),i=e.querySelector(".btn-city"),o=e.querySelector(".modal-city-container"),s=o.querySelector(".btn-close");n.length?n.map((e=>{a.insertAdjacentHTML("afterbegin",`\n    <button class="btn btn-danger btn-cities">${e}</button>\n  `)})):a.innerText="Список пуст",i.addEventListener("click",(()=>(e=>{e.classList.toggle("show")})(o))),s.addEventListener("click",(()=>{o.classList.remove("show")}))}(e,n,o),function(e,t){e.insertAdjacentHTML("beforeend",`\n          <section\n          class="\n            city-information\n            d-flex\n            flex-row\n            justify-content-around\n            align-items-center\n          "\n        >\n          <div class="city-information-precipValue">\n            <img src="http://openweathermap.org/img/wn/${null==t?void 0:t.weather[0].icon}@2x.png" alt="${null==t?void 0:t.weather.description}">\n            <div>${null==t?void 0:t.weather[0].description}</div>\n            <div>${["January","February","March","April","May","June","July","August","September","October","November","December"][new Date(1e3*(null==t?void 0:t.dt)).getMonth()]}, ${new Date(1e3*(null==t?void 0:t.dt)).getDate()}</div>\n          </div>\n          <div class="city-information-tempValue">\n            <div class="temp-value">${Math.floor(null==t?void 0:t.main.temp)}</div>\n            <div class="temp-value-degree"><sup>0</sup>C</div>\n          </div>\n        </section>\n`)}(e,a),function(e,t){e.insertAdjacentHTML("beforeend",'\n          <section class="city-weather-daily">\n          <h3>7-Day weather report</h3>\n          <div\n            class="\n              city-weather-daily-wrapper\n              d-flex\n              flex-row\n              justify-content-start\n            "\n          >          \n          </div>\n        </section>\n');const n=e.querySelector(".city-weather-daily-wrapper"),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.daily.map(((e,t)=>{t>0&&n.insertAdjacentHTML("beforeend",`\n  <div class="city-weather-daily-item d-flex flex-column justify-content-between align-items-center">\n    <h4>${a[new Date(1e3*e.dt).getMonth()]}, ${new Date(1e3*e.dt).getDate()}</h4>\n    <img src="http://openweathermap.org/img/wn/${null==e?void 0:e.weather[0].icon}@2x.png" alt="${null==e?void 0:e.weather[0].description}">\n    <div class="item-title">${null==e?void 0:e.weather[0].description}</div>\n    <div class="item-temp-value">${Math.floor(null==e?void 0:e.temp.day)} <sup>o</sup>C</div>\n  </div>\n`)}))}(e,i)}const t={name:"",current:{},daily:{},history:[],map:{},async setCurrent(){this.current=await async function(e){try{return(await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&appid=eaed0d5655c6e3e6b439dd8c5015b32e&units=metric`)).json()}catch(e){console.log(e.message)}}(this.name)},async setDaily(){this.daily=await async function(e){try{return(await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${null==e?void 0:e.coord.lat}&lon=${null==e?void 0:e.coord.lon}&exclude=minutely,hourly&appid=eaed0d5655c6e3e6b439dd8c5015b32e&units=metric`)).json()}catch(e){console.log(e.message)}}(this.current)},async setName(e){this.name=void 0!==e?e:await async function(){try{return(await fetch("https://get.geojs.io/v1/ip/geo.json")).json()}catch(e){console.log(e.message)}}().then((e=>e.city))||"Moscow"},setHistory(e){this.history=function(e){const t=JSON.parse(localStorage.getItem("cities"))??[];return t.includes(e.toLowerCase())||(t.length>=10&&t.shift(),t.push(e.toLowerCase()),localStorage.setItem("cities",JSON.stringify(t))),t}(e)},getHistory(){this.history=function(){const e=JSON.parse(localStorage.getItem("cities"))??[];return e.length>=10&&e.slice(0,10),e}()},renderMap(e){this.map=function(e){return new ymaps.Map("map",e)}(e)},setCenterMap(e){this.map.setCenter(e)}};async function n(){const a=document.querySelector("#app").querySelector(".container"),i=a.querySelector("form"),o=a.querySelector("input"),s=a.querySelectorAll(".cities-submenu button");i.addEventListener("submit",(async i=>{i.preventDefault();const s=o.value;await t.setName(s),await t.setCurrent(),await t.setDaily(),t.setHistory(s),e(a,t),t.setCenterMap([t.current.coord.lat,t.current.coord.lon]),await n()})),s.forEach((i=>{i.addEventListener("click",(async i=>{const o=i.target.innerText;await t.setName(o),await t.setCurrent(),await t.setDaily(),e(a,t),t.setCenterMap([t.current.coord.lat,t.current.coord.lon]),await n()}))}))}(async function(){const a=document.querySelector("#app").querySelector(".container");await t.setName(),await t.setCurrent(),await t.setDaily(),await async function(){return new Promise(((e,t)=>{const n=document.createElement("script");n.onload=e,n.onerror=t,n.type="text/javascript",n.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=928d9c6e-0b85-4e08-bb60-4334a283af57",document.body.appendChild(n)})).then((()=>new Promise((e=>ymaps.ready(e)))))}(),t.getHistory(),await e(a,t),t.renderMap({center:[t.current.coord.lat,t.current.coord.lon],zoom:10}),await n()})().then((()=>console.log("App running")))})()})();